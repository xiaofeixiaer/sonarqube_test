<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Index</title>

    <script src="jquery-3.4.1.min.js"></script>
</head>
<body>

<div>
    <label for="ip">目标IP地址</label><input id="ip"/>
    <br>
    <label for="ttl">TTL</label><input id="ttl"/>

    <button id="button-commit" onclick="tracerIp()">Tracer</button>
</div>
<br>
<div id="text">
</div>

<div id="error">
</div>
<script>
    function tracerIp() {
        var ip = $("#ip").val();
        var ttl = $("#ttl").val();
        $.ajax({
            url: "/ping",
            data: JSON.stringify({
                host: ip,
                ttl: ttl
            }),
            dataType: "json",
            contentType: "application/json;charset=utf-8",
            method: 'POST',
            success: function (result) {
                console.log(JSON.stringify(result));
                var current = "TTL = " + ttl + " |  From " + JSON.stringify(result) + "<br>";
                $("#text").html($("#text").html() + current);

                $("#button-commit").prop('disabled', false);
            },
            error: function (result) {
                $("#text").html(JSON.stringify(result));
                $("#button-commit").prop('disabled', false);
            }
        });
        $("#button-commit").prop('disabled', true);
        $("#ttl").val(++ttl);
    }
</script>
</body>
</html>